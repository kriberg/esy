

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; ESY 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Entities API" href="source/entities.html" />
    <link rel="prev" title="ESY Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ESY
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pagination">Pagination</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-semantic-wrapper">Using the semantic wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-bravado-interface">Using the Bravado interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caching">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication-and-devel-mode">Authentication and devel mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#development">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/entities.html">Entities API</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/esi.html">ESI API</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ESY</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/readme.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://travis-ci.org/kriberg/esy"><img alt="Build Status" src="https://travis-ci.org/kriberg/esy.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://coveralls.io/github/kriberg/esy?branch=master"><img alt="Coverage Status" src="https://coveralls.io/repos/github/kriberg/esy/badge.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://esy.readthedocs.io/en/latest/?badge=latest"><img alt="Documentation Status" src="https://readthedocs.org/projects/esy/badge/?version=latest" /></a>
<p>There are many options for consuming the ESI web services. ESY aims to be an easy-to-use library with the nuts and
bolts of dealing with an OpenAPI interface abstracted away.</p>
<p>ESY is inspired by Entity’s gloriously pythonic <a class="reference external" href="https://github.com/ntt/eveapi/">eveapi</a> library.</p>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The latest stable version of ESY is available from PyPI:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install esy
</pre></div>
</div>
</div>
<div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<p>Documentation is available at <a class="reference external" href="https://esy.readthedocs.io/en/latest/">esy.readthedocs.io</a>.</p>
<p>For documentation of the various ESI routes, ESY also provides a
<a class="reference external" href="https://esy.readthedocs.io/en/latest/source/esi.html">terse list</a> of their parameters and return types. Further
information can be explored at the main <a class="reference external" href="https://esi.evetech.net/ui">ESI documentation site</a></p>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>ESY comes with two interfaces to ESI:</p>
<ul class="simple">
<li>An interface generated by <a class="reference external" href="https://github.com/Yelp/bravado">Bravado</a>, with some added sugar for dealing with pagination.</li>
<li>A semantic wrapper generated through pythonic voodoo.</li>
</ul>
<p>The two interfaces caters different needs. The Bravado interface is an OpenAPI wrapper around the ESI that will
be familiar for most developers familiar working with swagger. The semantic wrapper, on the other hand, generates
classes for various entities in ESI like Character, Corporation and Alliance. Neither interface is mutual exclusive and
for many use cases, it makes sense using both.</p>
<p>Regardless of interface, to use ESY, you must first initialize a client:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">esy.client</span> <span class="kn">import</span> <span class="n">ESIClient</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">ESIClient</span><span class="o">.</span><span class="n">get_client</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s1">&#39;my-user-agent&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The client can take a second or two to initialize, as the swagger specification is downloaded and parsed. To speed this
up, you can download the specification locally:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl https://esi.evetech.net/latest/swagger.json -o swagger.json
</pre></div>
</div>
<p>Then initialize the client using the local file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">esy.client</span> <span class="kn">import</span> <span class="n">ESIClient</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;swagger.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">spec_file</span><span class="p">:</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">spec_file</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">ESIClient</span><span class="o">.</span><span class="n">get_client</span><span class="p">(</span><span class="s1">&#39;my-user-agent&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
<p>For production instances, keeping the spec in <a class="reference external" href="https://redis.io">Redis</a> or some other cache is highly recommended.</p>
<div class="section" id="pagination">
<h2>Pagination<a class="headerlink" href="#pagination" title="Permalink to this headline">¶</a></h2>
<p>For ESI routes which are paginated, ESY will return a <a class="reference external" href="source/modules.html#esy.client.ESIPageGenerator">ESIPageGenerator</a> which is a generator yielding the
native data type of the route.</p>
</div>
<div class="section" id="using-the-semantic-wrapper">
<h2>Using the semantic wrapper<a class="headerlink" href="#using-the-semantic-wrapper" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">esy.entities</span> <span class="kn">import</span> <span class="n">Character</span><span class="p">,</span> <span class="n">Corporation</span><span class="p">,</span> <span class="n">Alliance</span><span class="p">,</span> <span class="n">Entity</span>


<span class="c1"># You can initialize entities using their IDs</span>
<span class="n">vittoros</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="mi">941287462</span><span class="p">)</span>
<span class="n">evolution</span> <span class="o">=</span> <span class="n">Corporation</span><span class="p">(</span><span class="mi">144749962</span><span class="p">)</span>
<span class="n">ccp</span> <span class="o">=</span> <span class="n">Alliance</span><span class="p">(</span><span class="mi">434243723</span><span class="p">)</span>


<span class="c1"># To speed up initialization, it&#39;s recommended to create and share an ESIClient among instances.</span>
<span class="c1"># If no client is supplied, a new one will be created for each entity instance.</span>
<span class="kn">from</span> <span class="nn">esy.client</span> <span class="kn">import</span> <span class="n">ESIClient</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">ESIClient</span><span class="o">.</span><span class="n">get_client</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s1">&#39;my-user-agent&#39;</span><span class="p">)</span>

<span class="n">vittoros</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="mi">941287462</span><span class="p">,</span> <span class="n">_client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="c1"># You can also initialize instances just using the entity names</span>

<span class="n">vittoros</span> <span class="o">=</span> <span class="n">Character</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;Vittoros&#39;</span><span class="p">,</span> <span class="n">_client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>
<span class="n">evolution</span> <span class="o">=</span> <span class="n">Corporation</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;Evolution&#39;</span><span class="p">,</span> <span class="n">_client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="c1"># or speed things up by initializing many entites at the same time</span>

<span class="n">entities</span> <span class="o">=</span> <span class="n">Entity</span><span class="o">.</span><span class="n">from_names</span><span class="p">(</span><span class="s1">&#39;Vittoros&#39;</span><span class="p">,</span> <span class="s1">&#39;Evolution&#39;</span><span class="p">,</span> <span class="s1">&#39;Northern Coalition.&#39;</span><span class="p">,</span> <span class="n">_client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span>

<span class="p">{</span><span class="s1">&#39;Northern Coalition.&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">esy</span><span class="o">.</span><span class="n">entities</span><span class="o">.</span><span class="n">Alliance</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000023967F10860</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="s1">&#39;Vittoros&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">esy</span><span class="o">.</span><span class="n">entities</span><span class="o">.</span><span class="n">Character</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000023967F10BE0</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="s1">&#39;Evolution&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">esy</span><span class="o">.</span><span class="n">entities</span><span class="o">.</span><span class="n">Corporation</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000023967F10B70</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>Any initialized entity will allow you to access the various public information. To access the private services, you need
to supply an authorization token first.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vittoros</span> <span class="o">=</span> <span class="n">Character</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;Vittoros&#39;</span><span class="p">,</span> <span class="n">_client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> <span class="n">_token</span><span class="o">=</span><span class="s1">&#39;hunter2&#39;</span><span class="p">)</span>

<span class="c1"># or you can set the token after initialization</span>

<span class="n">vittoros</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s1">&#39;hunter2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>After this, you can access all the private services:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">asset_page</span> <span class="ow">in</span> <span class="n">vittoros</span><span class="o">.</span><span class="n">get_assets</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">asset_page</span><span class="p">)</span>

<span class="k">for</span> <span class="n">contract_page</span> <span class="ow">in</span> <span class="n">vittoros</span><span class="o">.</span><span class="n">get_contracts</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">contract</span> <span class="ow">in</span> <span class="n">contract_page</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">bid</span> <span class="ow">in</span> <span class="n">vittoros</span><span class="o">.</span><span class="n">get_contracts_contract_bids</span><span class="p">(</span><span class="n">contract_id</span><span class="o">=</span><span class="n">contract</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contract_id&#39;</span><span class="p">)):</span>
            <span class="k">print</span><span class="p">(</span><span class="n">bid</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bidder_id&#39;</span><span class="p">),</span> <span class="n">bid</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;amount&#39;</span><span class="p">),</span> <span class="n">bid</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;date_bid&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Check out the <a class="reference external" href="source/entities.html">entities API</a> for a more extensive list of available services.</p>
</div>
<div class="section" id="using-the-bravado-interface">
<h2>Using the Bravado interface<a class="headerlink" href="#using-the-bravado-interface" title="Permalink to this headline">¶</a></h2>
<p>The Bravado interface is available from the ESIClient instance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">esy.client</span> <span class="kn">import</span> <span class="n">ESIClient</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">ESIClient</span><span class="o">.</span><span class="n">get_client</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s1">&#39;my-user-agent&#39;</span><span class="p">)</span>

<span class="c1"># Get list of alliances</span>
<span class="n">alliances</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Alliance</span><span class="o">.</span><span class="n">get_alliances</span><span class="p">()</span>

<span class="c1"># Get info on a corporation</span>
<span class="n">evolution</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Corporation</span><span class="o">.</span><span class="n">get_corporations_corporation_id</span><span class="p">(</span><span class="n">corporation_id</span><span class="o">=</span><span class="mi">144749962</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">evolution</span><span class="p">)</span>

<span class="p">{</span><span class="s1">&#39;alliance_id&#39;</span><span class="p">:</span> <span class="mi">1727758877</span><span class="p">,</span>
 <span class="s1">&#39;ceo_id&#39;</span><span class="p">:</span> <span class="mi">144509256</span><span class="p">,</span>
 <span class="s1">&#39;creator_id&#39;</span><span class="p">:</span> <span class="mi">144509256</span><span class="p">,</span>
 <span class="s1">&#39;date_founded&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">tzutc</span><span class="p">()),</span>
 <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Those who cannot adapt become victims of Evolution.&#39;</span><span class="p">,</span>
 <span class="s1">&#39;home_station_id&#39;</span><span class="p">:</span> <span class="mi">60013843</span><span class="p">,</span>
 <span class="s1">&#39;member_count&#39;</span><span class="p">:</span> <span class="mi">316</span><span class="p">,</span>
 <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Evolution&#39;</span><span class="p">,</span>
 <span class="s1">&#39;shares&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
 <span class="s1">&#39;tax_rate&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
 <span class="s1">&#39;ticker&#39;</span><span class="p">:</span> <span class="s1">&#39;EVOL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.eve-evol.com&#39;</span><span class="p">,</span>
 <span class="s1">&#39;faction_id&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get paginated asset list</span>
<span class="n">swag</span> <span class="o">=</span>  <span class="n">client</span><span class="o">.</span><span class="n">Corporation</span><span class="o">.</span><span class="n">get_corporations_corporation_id_assets</span><span class="p">(</span><span class="n">corporation_id</span><span class="o">=</span><span class="mi">144749962</span><span class="p">,</span>
                                                                  <span class="n">_token</span><span class="o">=</span><span class="s1">&#39;esi token&#39;</span><span class="p">)</span>
<span class="c1"># swag is an ESIPageGenerator, implementing the generator interface</span>
<span class="c1"># Loop through it to get the asset pages</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">swag</span><span class="p">:</span>  <span class="c1"># Returns a list of assets</span>
    <span class="k">for</span> <span class="n">asset</span> <span class="ow">in</span> <span class="n">page</span><span class="p">:</span>  <span class="c1"># Asset dict</span>
       <span class="k">print</span><span class="p">(</span><span class="n">asset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type_id&#39;</span><span class="p">),</span>
             <span class="n">asset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;location_id&#39;</span><span class="p">))</span>
       <span class="c1"># 22457</span>
       <span class="c1"># 16074150552</span>
</pre></div>
</div>
</div>
<div class="section" id="caching">
<h2>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h2>
<p>ESY does not implement caching itself, but supports using a cache through a cache proxy object. The proxy needs
to implement the following interface:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Cache</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">cached_until</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="authentication-and-devel-mode">
<h2>Authentication and devel mode<a class="headerlink" href="#authentication-and-devel-mode" title="Permalink to this headline">¶</a></h2>
<p>ESY can handle the authentication flow for you:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">esy.auth</span> <span class="kn">import</span> <span class="n">ESIAuthenticator</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">ESIAuthenticator</span><span class="p">()</span>
<span class="n">refresh_token</span><span class="p">,</span> <span class="n">access_token</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">verify_authorization_code</span><span class="p">(</span><span class="s1">&#39;authorization code from esi&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;your secret key&#39;</span><span class="p">)</span>

<span class="n">auth</span><span class="o">.</span><span class="n">verify_access_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;CharacterID&#39;</span><span class="p">:</span> <span class="mi">941287462</span><span class="p">,</span>
 <span class="s1">&#39;CharacterName&#39;</span><span class="p">:</span> <span class="s1">&#39;Vittoros&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ExpiresOn&#39;</span><span class="p">:</span> <span class="s1">&#39;2018-06-11T19:01:15.182864Z&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Scopes&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
 <span class="s1">&#39;TokenType&#39;</span><span class="p">:</span> <span class="s1">&#39;Character&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CharacterOwnerHash&#39;</span><span class="p">:</span> <span class="s1">&#39;**********&#39;</span><span class="p">}</span>

<span class="n">new_access_token</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_access_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">,</span>
                                         <span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;your secret key&#39;</span><span class="p">)</span>

<span class="n">auth</span><span class="o">.</span><span class="n">revoke_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">,</span>
                  <span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;your secret key&#39;</span><span class="p">)</span>

<span class="n">auth</span><span class="o">.</span><span class="n">revoke_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span>
                  <span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;your secret key&#39;</span><span class="p">,</span>
                  <span class="n">token_type</span><span class="o">=</span><span class="s1">&#39;access_token&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To help developers getting started without having to implement the entire authentication
workflow, ESY also implements an ad-hoc web server to get you refresh tokens. You can use
it directly in the python prompt to do some API exploration or you can use it in your tests
to produce refresh or access tokens for testing your ESI calls.</p>
<p>First, create a new application at <a class="reference external" href="https://developers.eveonline.com/">https://developers.eveonline.com/</a>
with callback URL set to <a class="reference external" href="http://localhost:8000">http://localhost:8000</a> or whichever address and port you’ll be
running the devel server.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">esy.devel</span>

<span class="c1"># get_authorization_code has many parameters, but for basic usage:</span>

<span class="n">auth_code</span> <span class="o">=</span> <span class="n">esy</span><span class="o">.</span><span class="n">devel</span><span class="o">.</span><span class="n">get_authorization_code</span><span class="p">(</span><span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                                             <span class="n">callback_url</span><span class="o">=</span><span class="s1">&#39;your callback URL&#39;</span><span class="p">,</span>
                                             <span class="n">scopes</span><span class="o">=</span><span class="s1">&#39;your space-delimited scopes&#39;</span><span class="p">)</span>

<span class="c1"># This will start the web server in the background (per-default listening on localhost:8000)</span>
<span class="c1"># and print the login URL on stdout. After authenticating in your browser, the web server</span>
<span class="c1"># will get redirect from the SSO with the authorization code, then return that.</span>

<span class="c1"># For situations where you are not able to reach the network where you are running ESY,</span>
<span class="c1"># you can also use CLI login:</span>

<span class="n">auth_code</span> <span class="o">=</span> <span class="n">esy</span><span class="o">.</span><span class="n">devel</span><span class="o">.</span><span class="n">get_authorization_code</span><span class="p">(</span><span class="n">cli_login</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                             <span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                                             <span class="n">callback_url</span><span class="o">=</span><span class="s1">&#39;your callback URL&#39;</span><span class="p">,</span>
                                             <span class="n">scopes</span><span class="o">=</span><span class="s1">&#39;your space-delimited scopes&#39;</span><span class="p">)</span>

<span class="c1"># This will prompt for username and password, then let you pick a character.</span>
<span class="c1"># If you are running tests, you can also supply username, password and character_id as</span>
<span class="c1"># keyword arguments to get_authorization_code, in addition to cli_login=True. This will</span>
<span class="c1"># automate the entire flow. Remember to revoke your tokens afterwards and for bob&#39;s sake;</span>
<span class="c1"># don&#39;t display your username and/or password!</span>

<span class="c1"># After getting the authorization code, you can get the tokens:</span>

<span class="n">refresh_token</span><span class="p">,</span> <span class="n">access_token</span> <span class="o">=</span> <span class="n">esy</span><span class="o">.</span><span class="n">devel</span><span class="o">.</span><span class="n">verify_authorization_code</span><span class="p">(</span><span class="n">auth_code</span><span class="p">,</span>
                                                                  <span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;your client ID&#39;</span><span class="p">,</span>
                                                                  <span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;your secret key&#39;</span><span class="p">)</span>
<span class="c1"># Character info</span>

<span class="n">char_info</span> <span class="o">=</span> <span class="n">esy</span><span class="o">.</span><span class="n">devel</span><span class="o">.</span><span class="n">verify_access_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">)</span>

<span class="c1"># Get your swag</span>
<span class="kn">from</span> <span class="nn">esy.client</span> <span class="kn">import</span> <span class="n">ESIClient</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">ESIClient</span><span class="o">.</span><span class="n">get_client</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s1">&#39;your-user-agent&#39;</span><span class="p">)</span>
<span class="n">assets</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Assets</span><span class="o">.</span><span class="n">get_characters_character_id_assets</span><span class="p">(</span>
    <span class="n">character_id</span><span class="o">=</span><span class="n">char_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CharacterID&#39;</span><span class="p">),</span> <span class="n">_token</span><span class="o">=</span><span class="n">access_token</span><span class="p">)</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">assets</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</pre></div>
</div>
<p>The devel mode will use parameters from environment settings, if present:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Environment setting</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CLIENT_ID</td>
<td>ESY_CLIENT_ID</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>SECRET_KEY</td>
<td>ESY_SECRET_KEY</td>
<td>None</td>
</tr>
<tr class="row-even"><td>SCOPES</td>
<td>ESY_SCOPES</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>CALLBACK_URL</td>
<td>ESY_CALLBACK_URL</td>
<td><a class="reference external" href="http://localhost:8000">http://localhost:8000</a></td>
</tr>
<tr class="row-even"><td>SERVER_ADDRESS</td>
<td>ESY_SERVER_ADDRESS</td>
<td>localhost</td>
</tr>
<tr class="row-odd"><td>SERVER_PORT</td>
<td>ESY_SERVER_PORT</td>
<td>8000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h1>
<p>ESY uses the <a class="reference external" href="https://github.com/Yelp/bravado-core">Bravado</a> OpenAPI library to parse the ESI swagger schema and create
an usable interface. The purpose of creating a custom wrapper of Bravado for ESI, is to make the interface a bit more
user friendly. Pagination is handled automatically by returning generators for any route which accepts a page
parameter, while non-paginated data is handled in their native data type. Tokens can be set per-call, instead of
per-client, allowing for using headers and still getting data for many tokens without the ned to reinitialize the client.</p>
<p>The authentication flow uses <a class="reference external" href="https://github.com/requests/requests-oauthlib">requests-oauthlib</a>.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="source/entities.html" class="btn btn-neutral float-right" title="Entities API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="ESY Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Kristian Berg

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>